DECLARE SUB s ()
START: SCREEN 9: t = 0: W = 0: CI = 0: ZS = 100: CS = 100: wi = -1
WINDOW SCREEN (0, -20)-(640, 370)
DIM A(84) AS LONG, A2(84) AS LONG, A6(485) AS LONG, STE(60) AS INTEGER
DIM I(18, 18) AS INTEGER, J(18, 18) AS INTEGER, I1(18, 18) AS INTEGER, PN(70)
DIM J1(18, 18) AS INTEGER, I3(15) AS INTEGER, J3(15) AS INTEGER, PX(70)
DIM I4(15) AS INTEGER, J4(15) AS INTEGER, CJ3(19, 15) AS INTEGER, PY(70)
DIM CJ4(19, 15) AS INTEGER, SJ4(19, 15) AS INTEGER, SJ3(19, 15) AS INTEGER
DIM F1(55) AS INTEGER, F2(55) AS INTEGER, WAY1(15, 65, 14) AS INTEGER
DIM WAY2(15, 65, 14) AS INTEGER, BY1(20) AS INTEGER, BY2(20) AS INTEGER
DIM CHY(15, 65), CHX(15, 65) AS INTEGER, CB(15) AS INTEGER, M(17) AS INTEGER
DIM FHX(15, 15) AS INTEGER, FHY(15, 15) AS INTEGER, WM(17) AS INTEGER
DIM WX(17) AS INTEGER, NUM(60) AS INTEGER, TEXT(130) AS LONG
DIM WY(17) AS INTEGER, G1(20) AS INTEGER, G2(20) AS INTEGER, QP(15) AS INTEGER
DIM D1(20) AS INTEGER, B1(20) AS INTEGER, PL(70) AS INTEGER, Q2(185), Q12(33)
DIM SM(16) AS INTEGER, SFX(15, 16) AS INTEGER, SFY(15, 16) AS INTEGER
DIM SHX(15, 55) AS INTEGER, SHY(15, 55), DJ1(90)  AS INTEGER
DIM DJ2(90) AS INTEGER, DJ3(90) AS INTEGER, DJ4(90) AS INTEGER, Q1(75)
DIM WAY3(20, 15) AS INTEGER, WAY4(20, 15) AS INTEGER, b2(9180) AS LONG
DEF FNF (J) = 308 + (J) * 16: DEF FNQ (J) = 3 + (16 - J) * 20
FOR I = 0 TO 130: READ TEXT(I): NEXT I
IF STT <> 0 THEN 14
OPEN "DIA.GRA" FOR INPUT AS #2
FOR I = 1 TO 685: INPUT #2, EEE, DDD: NEXT I
FOR I = 0 TO 84: INPUT #2, A(I): NEXT I
FOR I = 0 TO 84: INPUT #2, A2(I): NEXT I
FOR I = 0 TO 480: INPUT #2, A6(I): NEXT
OPEN "G1" FOR INPUT AS #1
FOR F = 0 TO 9180
IF F MOD 100 = 0 THEN GOSUB 121: GOSUB 121: GOSUB 121: GOSUB 121
INPUT #1, b2(F)
NEXT F
v = 375: P = 250: GOSUB 67
PUT (170, 60), b2
CLOSE #1
223 DO
we = we + .1: IF qa <> 0 THEN PUT (315 + qa * 100, 175 + qd * 60), A, XOR: PUT (315 - qa * 100, 175 + qd * 60), A2, XOR
qa = 2 * COS(we) - .5 * COS((2) * we / .5)
qd = 2 * SIN(we) - .5 * SIN((2) * we / .5)
GOSUB 121: GOSUB 121: GOSUB 121: GOSUB 121: GOSUB 121
PUT (315 + qa * 100, 175 + qd * 60), A, XOR: PUT (315 - qa * 100, 175 + qd * 60), A2, XOR
FOR IO = 0 TO 63000: NEXT IO
LOOP UNTIL INKEY$ <> ""
PUT (315 + qa * 100, 175 + qd * 60), A, XOR: PUT (315 - qa * 100, 175 + qd * 60), A2, XOR
PUT (170, 60), b2, XOR
LINE (0, 0)-(100, 70), 0, BF
LINE (375, 250)-STEP(20, 20), 0, BF
14 XX1 = 5: YY1 = 3: x = 402: Y = 283
IF STT <> 0 THEN PCOPY 1, 0
IF STT <> 0 THEN GET (x, Y)-STEP(20, 20), Q1: v = x: P = Y: GOSUB 67
IF STT <> 0 THEN GET (x, Y)-STEP(40, 3), Q12: GOTO 455
PUT (500, 180), A: PUT (570, 180), A2
343 HL = 222: GOSUB DI
PUT (0, 0), A6
IF STT = 0 THEN PCOPY 0, 1
GET (x, Y)-STEP(20, 20), Q1: v = x: P = Y: GOSUB 67
GET (x, Y)-STEP(40, 3), Q12
GOTO 455
DI: FOR I = 0 TO 6.283 STEP 6.283 / 3: N = N + 1
x(N) = 320 + COS(I - (6.283 / 4)) * HL
X1(N) = 320 + COS(I - (6.283 / 4) + 3.14) * HL
Y(N) = (175 + SIN(I - 6.28 / 4) * HL * .73)
X1(N) = 320 + COS(I - (6.283 / 4) + 3.14) * HL:
Y1(N) = (175 + SIN(I - (6.28 / 4) + 3.14) * HL * .73)
NEXT: N = 0: FOR I = 1 TO 3
IF I = 3 THEN x(4) = x(1): Y(4) = Y(1): X1(4) = X1(1): Y1(4) = Y1(1)
LINE (X1(I), Y1(I))-(X1(I + 1), Y1(I + 1)), 1
LINE (x(I), Y(I))-(x(I + 1), Y(I + 1)), 1: NEXT: PAINT (320, 170), 15, 1
PAINT (320, Y(1) + 9), 4, 1: PAINT (320, Y1(1) - 9), 4, 1
PAINT (X1(2) + 7, Y1(2) + 2), 14, 1: PAINT (x(2) - 7, Y(2) - 2), 14, 1
PAINT (x(3) + 7, Y(3) - 2), 1, 1: PAINT (X1(3) - 7, Y1(3) + 2), 1, 1
FOR I = 1 TO 12
Z = x(3) + (x(2) - x(3)) / 12 * I: Q = Y(1) + (Y(2) - Y(1)) / 12 * I
Z1 = x(1) + (x(2) - x(1)) / 12 * I
Z2 = x(1) - (x(2) - x(1)) / 12 * I: Z3 = x(2) - (x(2) - x(3)) / 12 * I
LINE (Z, Y(2))-(Z1, Q), 0: LINE (Z3, Y(2))-(Z2, Q), 0: LINE (Z1, Q)-(Z2, Q), 0
NEXT: FOR I = 1 TO 12
Z = x(3) + (x(2) - x(3)) / 12 * I: Q = Y1(1) - (Y1(1) - Y1(2)) / 12 * I
Z1 = X1(1) - (X1(2) - X1(1)) / 12 * I: Z3 = X1(3) - (X1(3) - X1(2)) / 12 * I
Z2 = X1(1) + (X1(2) - X1(1)) / 12 * I: LINE (Z, Y1(2))-(Z1, Q), 0
LINE (Z3, Y1(2))-(Z2, Q), 0: LINE (Z1, Q)-(Z2, Q), 0
NEXT: ERASE X1, Y1, x, Y: Z1 = 0
RETURN
455 DIM AA(90), BB(90), CC(90), DD(90), EE(90), FF(90), HH(90), II(90), JJ(90), KK(90), LL(90), MM(90), NN(90), OO(90), GG(90)
FOR U = 0 TO 3: G = G + 1
FOR A = G TO 12: I(A, U) = -1: I1(A, U) = -1: J(A, 16 - U) = -1
J1(A, 16 - U) = -1: J(A, U) = -1: J1(A, U) = -1: I(A, 16 - U) = -1
I1(A, 16 - U) = -1: NEXT A, U: JE = 15
FOR I = 4 TO 12: IF I < 9 THEN JE = JE - 1 ELSE JE = JE + 1
I1(JE, I) = -1: I(JE, I) = -1: NEXT I
I(3, 4) = -1: I1(3, 4) = -1: I(1, 4) = -1: I1(1, 4) = -1: I(2, 3) = -1
I1(2, 3) = -1: I1(0, 3) = -1: I(1, 2) = -1: I1(1, 2) = -1: I1(0, 1) = -1
J(3, 12) = -1: J1(3, 12) = -1: J(1, 12) = -1: J1(1, 12) = -1: J(2, 13) = -1
J1(2, 13) = -1: J1(0, 13) = -1: J(1, 14) = -1: J1(1, 14) = -1: J1(0, 15) = -1
IF STT = 1 THEN  ELSE 11
456 LOCATE 7, 1
INPUT "Saved Nmae of File(.dia)"; F$: LINE (0, 68)-STEP(260, 20), 0, BF
STT = 0
F$ = F$ + ".DIA"
IF F$ = "0.DIA" OR F$ = ".DIA" THEN 11
CLOSE #1
CLOSE #2
OPEN "DIAMOND.TLT" FOR INPUT AS #2
311 INPUT #2, W2$: ON ERROR GOTO 456
IF W2$ = F$ THEN  ELSE 311
OPEN F$ FOR INPUT AS #1: ON ERROR GOTO 456
CLOSE #2
FOR H = 1 TO 15
INPUT #1, I3(H), I4(H), J3(H), J4(H)
NEXT H: N = 5
CLOSE #1: GOSUB CHO
GOTO 171
11 J3(1) = -4: J4(1) = 12: J3(2) = -2: J4(2) = 12: J3(3) = 0: J4(3) = 12
J3(4) = 2: J4(4) = 12: J3(5) = 4: J4(5) = 12: J3(6) = -3: J4(6) = 13
J3(7) = -1: J4(7) = 13: J3(8) = 1: J4(8) = 13: J3(9) = 3: J4(9) = 13
J3(10) = -2: J4(10) = 14: J3(11) = 0: J4(11) = 14: J3(12) = 2: J4(12) = 14
J3(13) = -1: J4(13) = 15: J3(14) = 1: J4(14) = 15: J3(15) = 0: J4(15) = 16
I3(1) = -4: I4(1) = 4: I3(2) = -2: I4(2) = 4: I3(3) = 0: I4(3) = 4: I3(4) = 2
I4(4) = 4: I3(5) = 4: I4(5) = 4: I3(6) = -3: I4(6) = 3: I3(7) = -1: I4(7) = 3
I3(8) = 1: I4(8) = 3: I3(9) = 3: I4(9) = 3: I3(10) = -2: I4(10) = 2
I3(11) = 0: I4(11) = 2: I3(12) = 2: I4(12) = 2: I3(13) = -1: I4(13) = 1
I3(14) = 1: I4(14) = 1: I3(15) = 0: I4(15) = 0
171 FOR I = 1 TO 15
IF J3(I) > 0 THEN J(J3(I), J4(I)) = I: I(J3(I), J4(I)) = 0: GOTO 5
J1(ABS(J3(I)), J4(I)) = I: I1(ABS(J3(I)), J4(I)) = 0
5 IF I3(I) > 0 THEN I(I3(I), I4(I)) = I: J(I3(I), I4(I)) = 0: GOTO 4
I1(ABS(I3(I)), I4(I)) = I: J1(ABS(I3(I)), I4(I)) = 0
4 NEXT I
AA1 = FNF(I3(1)): AA2 = FNQ(I4(1)): BB1 = FNF(I3(2)): BB2 = FNQ(I4(2))
CC1 = FNF(I3(3)): CC2 = FNQ(I4(3)): DD1 = FNF(I3(4)): DD2 = FNQ(I4(4))
EE1 = FNF(I3(5)): EE2 = FNQ(I4(5)): FF1 = FNF(I3(6)): FF2 = FNQ(I4(6))
GG1 = FNF(I3(7)): GG2 = FNQ(I4(7)): HH1 = FNF(I3(8)): HH2 = FNQ(I4(8))
II1 = FNF(I3(9)): II2 = FNQ(I4(9)): JJ1 = FNF(I3(10)): JJ2 = FNQ(I4(10))
KK1 = FNF(I3(11)): KK2 = FNQ(I4(11)): LL1 = FNF(I3(12)): LL2 = FNQ(I4(12))
MM1 = FNF(I3(13)): MM2 = FNQ(I4(13)): NN1 = FNF(I3(14)): NN2 = FNQ(I4(14))
OO1 = FNF(I3(15)): OO2 = FNQ(I4(15))
GET (AA1, AA2)-STEP(29, 20), AA: GET (BB1, BB2)-STEP(29, 20), BB
GET (CC1, CC2)-STEP(29, 20), CC: GET (DD1, DD2)-STEP(29, 20), DD
GET (EE1, EE2)-STEP(29, 20), EE: GET (FF1, FF2)-STEP(29, 20), FF
GET (GG1, GG2)-STEP(29, 20), GG: GET (HH1, HH2)-STEP(29, 20), HH
GET (II1, II2)-STEP(29, 20), II: GET (JJ1, JJ2)-STEP(29, 20), JJ
GET (KK1, KK2)-STEP(29, 20), KK: GET (LL1, LL2)-STEP(29, 20), LL
GET (MM1, MM2)-STEP(29, 20), MM: GET (NN1, NN2)-STEP(29, 20), NN
GET (OO1, OO2)-STEP(29, 20), OO
D = AA1: E = AA2: GOSUB 333: D = BB1: E = BB2: GOSUB 333
D = CC1: E = CC2: GOSUB 333: D = DD1: E = DD2: GOSUB 333
D = EE1: E = EE2: GOSUB 333: D = FF1: E = FF2: GOSUB 333
D = GG1: E = GG2: GOSUB 333: D = HH1: E = HH2: GOSUB 333
D = II1: E = II2: GOSUB 333: D = JJ1: E = JJ2: GOSUB 333
D = KK1: E = KK2: GOSUB 333: D = LL1: E = LL2: GOSUB 333
D = MM1: E = MM2: GOSUB 333: D = NN1: E = NN2: GOSUB 333
D = OO1: E = OO2: GOSUB 333:
DIM AA3(90), BB3(90), CC3(90), DD3(90), EE3(90), FF3(90), GG3(90), HH3(90)
DIM II3(90), JJ3(90), KK3(90), LL3(90), MM3(90), NN3(90), OO3(90)
AA4 = FNF(J3(1)): AA5 = FNQ(J4(1)): BB4 = FNF(J3(2)): BB5 = FNQ(J4(2))
CC4 = FNF(J3(3)): CC5 = FNQ(J4(3)): DD4 = FNF(J3(4)): DD5 = FNQ(J4(4))
EE4 = FNF(J3(5)): EE5 = FNQ(J4(5)): FF4 = FNF(J3(6)): FF5 = FNQ(J4(6))
GG4 = FNF(J3(7)): GG5 = FNQ(J4(7)): HH4 = FNF(J3(8)): HH5 = FNQ(J4(8))
II4 = FNF(J3(9)): II5 = FNQ(J4(9)): JJ4 = FNF(J3(10)): JJ5 = FNQ(J4(10))
KK4 = FNF(J3(11)): KK5 = FNQ(J4(11)): LL4 = FNF(J3(12)): LL5 = FNQ(J4(12))
MM4 = FNF(J3(13)): MM5 = FNQ(J4(13)): NN4 = FNF(J3(14)): NN5 = FNQ(J4(14))
OO4 = FNF(J3(15)): OO5 = FNQ(J4(15))
GET (AA4, AA5)-STEP(29, 20), AA3: GET (BB4, BB5)-STEP(29, 20), BB3
GET (CC4, CC5)-STEP(29, 20), CC3: GET (DD4, DD5)-STEP(29, 20), DD3
GET (EE4, EE5)-STEP(29, 20), EE3: GET (FF4, FF5)-STEP(29, 20), FF3
GET (GG4, GG5)-STEP(29, 20), GG3: GET (HH4, HH5)-STEP(29, 20), HH3
GET (II4, II5)-STEP(29, 20), II3: GET (JJ4, JJ5)-STEP(29, 20), JJ3
GET (KK4, KK5)-STEP(29, 20), KK3: GET (LL4, LL5)-STEP(29, 20), LL3
GET (MM4, MM5)-STEP(29, 20), MM3: GET (NN4, NN5)-STEP(29, 20), NN3
GET (OO4, OO5)-STEP(29, 20), OO3
GOSUB CHO:
D = AA4: E = AA5: GOSUB 334: D = FF4: E = FF5: GOSUB 334
D = BB4: E = BB5: GOSUB 334: D = GG4: E = GG5: GOSUB 334
D = CC4: E = CC5: GOSUB 334: D = HH4: E = HH5: GOSUB 334
D = DD4: E = DD5: GOSUB 334: D = II4: E = II5: GOSUB 334
D = EE4: E = EE5: GOSUB 334: D = JJ4: E = JJ5: GOSUB 334
D = KK4: E = KK5: GOSUB 334: D = LL4: E = LL5: GOSUB 334
D = MM4: E = MM5: GOSUB 334: D = NN4: E = NN5: GOSUB 334
D = OO4: E = OO5: GOSUB 334: NP = 1
DIM A5$(70): K = 1
CLOSE #3
OPEN "rsc" FOR INPUT AS #3
691 INPUT #3, D, A: ON ERROR GOTO 1
REM LINE (390 + D * .83, 306 + A * .8)-STEP(1, 1), 15, B
REM LINE (391 + D * .83, 307 + A * .8)-STEP(1, 1), 8, B
GOTO 691
1 A4$ = INKEY$: IF STT <> 2 THEN 81
IF A4$ = CHR$(27) THEN K = 67
IF K < 67 THEN A4$ = A5$(K): K = K + 1 ELSE SLEEP: CLEAR : STT = 3: GOTO START
TI = INT(TIMER * 10)
80 IF INT(TIMER * 10) - TI = 2 THEN  ELSE 80
81 IF A4$ = "" THEN 1
IF A4$ = CHR$(0) + CHR$(75) THEN GOSUB 100
IF A4$ = CHR$(0) + CHR$(77) THEN GOSUB 200
IF A4$ = CHR$(0) + CHR$(80) THEN GOSUB 300
IF A4$ = CHR$(0) + CHR$(72) THEN GOSUB 400
IF A4$ = CHR$(25) THEN CLEAR : STT = 1: PCOPY 1, 0: GOTO START:               'IF A4$ = CHR$(0) + CHR$(59) THEN CLEAR : STT = 2: PCOPY 1, 0: GOTO START
IF A4$ = "0" THEN GOSUB A1
IF A4$ = CHR$(27) THEN END ELSE
IF A4$ = CHR$(26) THEN 232
IF A4$ = CHR$(32) OR A4$ <> "" THEN GOSUB 500
GOTO 1
100 IF x < 135 THEN RETURN 1
IF Y > 331 THEN GOTO 102 ELSE
XX1 = XX1 - 1: PUT (x, Y), Q1, PSET: x = x - 31.7537 / 2
GET (x, Y)-STEP(20, 20), Q1: v = x: P = Y: GOSUB 67: RETURN 1
102 PUT (x, Y - 1), Q1, PSET
XX1 = XX1 - 1: x = x - 31.7537 / 2
GET (x, Y)-STEP(20, 4), Q1: PUT (x, Y), Q12: RETURN 1
200 IF x > 510 THEN RETURN 1
IF Y > 331 THEN GOTO 202 ELSE
XX1 = XX1 + 1: PUT (x, Y), Q1, PSET: x = x + 31.7537 / 2
GET (x, Y)-STEP(20, 20), Q1: v = x: P = Y: GOSUB 67: RETURN 1
202 PUT (x, Y - 1), Q1, PSET: XX1 = XX1 + 1
x = x + 31.7537 / 2: GET (x, Y)-STEP(20, 4), Q1: PUT (x, Y), Q12: RETURN 1
300 IF Y > 314 THEN PUT (x, Y), Q1, PSET: GOTO 302 ELSE
YY1 = YY1 - 1: PUT (x, Y), Q1, PSET: Y = Y + 20.083: IF Y = 320 THEN RETURN 1
GET (x, Y)-STEP(20, 20), Q1: v = x: P = Y: GOSUB 67: RETURN 1
302 IF Y > 340 THEN PUT (x, Y), Q12: RETURN 1
YY1 = YY1 - 1: Y = Y + 20.083
GET (x, Y)-STEP(20, 5), Q1: PUT (x, Y), Q12: RETURN 1
400 IF Y - 20.9771 < 5 THEN RETURN 1
YY1 = YY1 + 1: PUT (x, Y), Q1, PSET: Y = Y - 20.083
IF Y < 296 THEN GET (x, Y)-STEP(20, 20), Q1 ELSE GET (x, Y)-STEP(20, 20), Q1
v = x: P = Y: GOSUB 67: RETURN 1
500 IF CS = 0 THEN GOSUB CHO
40 IF W > 0 THEN  ELSE 56
IF XX1 > 0 THEN 93 ELSE 94
93 IF J(XX1, YY1) > 0 THEN CALL s: RETURN 1
IF I(XX1, YY1) > 0 THEN D = FNF(I3(W)): E = FNQ(I4(W)) ELSE 222
IF X3 > 0 THEN I(X3, Y3) = W ELSE I1(ABS(X3), Y3) = W
PUT (x, Y), Q1, PSET: GOSUB 333
IF Y < 325 THEN GET (x, Y)-STEP(20, 20), Q1 ELSE GET (x, Y)-STEP(20, 5), Q1
IF Y < 325 THEN v = x: P = Y: GOSUB 67 ELSE PUT (x, Y), Q12
GOTO 56
94 IF J1(ABS(XX1), YY1) > 0 THEN CALL s: RETURN 1
IF I1(ABS(XX1), YY1) > 0 THEN D = FNF(I3(W)): E = FNQ(I4(W)) ELSE 222
IF X3 > 0 THEN I(X3, Y3) = W ELSE I1(ABS(X3), Y3) = W
PUT (x, Y), Q1, PSET: GOSUB 333
IF Y < 325 THEN GET (x, Y)-STEP(20, 20), Q1 ELSE GET (x, Y)-STEP(20, 5), Q1
IF Y < 325 THEN v = x: P = Y: GOSUB 67 ELSE PUT (x, Y), Q12
GOTO 56
222 IF YY1 - I4(W) = 1 AND XX1 - I3(W) = 1 THEN QB = 0: GOTO 24
IF YY1 - I4(W) = 1 AND XX1 - I3(W) = -1 THEN QB = 0: GOTO 24
IF YY1 - I4(W) = -1 AND XX1 - I3(W) = 1 THEN QB = 0: GOTO 24
IF YY1 - I4(W) = -1 AND XX1 - I3(W) = -1 THEN QB = 0: GOTO 24
IF YY1 - I4(W) = 0 AND XX1 - I3(W) = 2 THEN QB = 0: GOTO 24
IF YY1 - I4(W) = 0 AND XX1 - I3(W) = -2 THEN QB = 0: GOTO 24
IF XX1 = I3(W) AND YY1 = I4(W) THEN QB = 0: GOTO 24 ELSE 25
25 WRE = 0: WM(0) = 0: WX(0) = XX1: WY(0) = YY1: QB = 0
191 IF WM(WRE) = 1 THEN 192
WK = WX(WRE) + 2: WJ = WY(WRE)
IF WK > 0 THEN IF I(WK, WJ) > 0 OR J(WK, WJ) > 0 THEN  ELSE 192 ELSE 172
QB = QB + 1: GOSUB 181: GOTO 192
172 IF I1(ABS(WK), WJ) > 0 OR J1(ABS(WK), WJ) > 0 THEN QB = QB + 1: GOSUB 181
192 IF WM(WRE) = 2 THEN 193
WK = WX(WRE) - 2: WJ = WY(WRE)
IF WK > 0 THEN IF I(WK, WJ) > 0 OR J(WK, WJ) > 0 THEN  ELSE 193 ELSE 173
QB = QB + 1: GOSUB 182: GOTO 193
173 IF I1(ABS(WK), WJ) > 0 OR J1(ABS(WK), WJ) > 0 THEN QB = QB + 1: GOSUB 182
193 IF WM(WRE) = 3 THEN 194
WK = WX(WRE) + 1: WJ = WY(WRE) + 1
IF WK > 0 THEN IF I(WK, WJ) > 0 OR J(WK, WJ) > 0 THEN  ELSE 194 ELSE 174
QB = QB + 1: GOSUB 183: GOTO 194
174 IF I1(ABS(WK), WJ) > 0 OR J1(ABS(WK), WJ) > 0 THEN QB = QB + 1: GOSUB 183
194 IF WM(WRE) = 4 THEN 195
WK = WX(WRE) + 1: WJ = WY(WRE) - 1: IF WJ <= 0 THEN 195
IF WK > 0 THEN IF I(WK, WJ) > 0 OR J(WK, WJ) > 0 THEN  ELSE 195 ELSE 175
QB = QB + 1: GOSUB 184: GOTO 195
175 IF I1(ABS(WK), WJ) > 0 OR J1(ABS(WK), WJ) > 0 THEN QB = QB + 1: GOSUB 184
195 IF WM(WRE) = 5 THEN 196
WK = WX(WRE) - 1: WJ = WY(WRE) + 1
IF WK > 0 THEN IF I(WK, WJ) > 0 OR J(WK, WJ) > 0 THEN  ELSE 196 ELSE 176
QB = QB + 1: GOSUB 185: GOTO 196
176 IF I1(ABS(WK), WJ) > 0 OR J1(ABS(WK), WJ) > 0 THEN QB = QB + 1: GOSUB 185
196 IF WM(WRE) = 6 THEN 197
WK = WX(WRE) - 1: WJ = WY(WRE) - 1: IF WJ <= 0 THEN 197
IF WK > 0 THEN IF I(WK, WJ) > 0 OR J(WK, WJ) > 0 THEN  ELSE 197 ELSE 177
QB = QB + 1: GOSUB 186: GOTO 197
177 IF I1(ABS(WK), WJ) > 0 OR J1(ABS(WK), WJ) > 0 THEN QB = QB + 1: GOSUB 186
197 IF WRE = 0 THEN CALL s: RETURN 1 ELSE WRE = WRE - 1: QB = QB - 1: RETURN
181 WK1 = WK + 2: WJ1 = WJ: GOSUB OK1: WM(WRE) = 2: QB = QB + 1: GOSUB 191
QB = QB - 1: RETURN
182 WK1 = WK - 2: WJ1 = WJ: GOSUB OK1: WM(WRE) = 1: QB = QB + 1: GOSUB 191
QB = QB - 1: RETURN
183 WK1 = WK + 1: WJ1 = WJ + 1: GOSUB OK1: WM(WRE) = 6: QB = QB + 1: GOSUB 191
QB = QB - 1: RETURN
184 WK1 = WK + 1: WJ1 = WJ - 1: GOSUB OK1: WM(WRE) = 5: QB = QB + 1: GOSUB 191
QB = QB - 1: RETURN
185 WK1 = WK - 1: WJ1 = WJ + 1: GOSUB OK1: WM(WRE) = 4: QB = QB + 1: GOSUB 191
QB = QB - 1: RETURN
186 WK1 = WK - 1: WJ1 = WJ - 1: GOSUB OK1: WM(WRE) = 3: QB = QB + 1: GOSUB 191
QB = QB - 1: RETURN
24 IF QB = 0 THEN 12
FOR I = 1 TO QB: RETURN 7
7 NEXT
12 D = FNF(XX1): E = FNQ(YY1)
ON W GOTO 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55
41 AA1 = D: AA2 = E: GET (AA1, AA2)-STEP(29, 20), AA: GOTO 33
42 BB1 = D: BB2 = E: GET (BB1, BB2)-STEP(29, 20), BB: GOTO 33
43 CC1 = D: CC2 = E: GET (CC1, CC2)-STEP(29, 20), CC: GOTO 33
44 DD1 = D: DD2 = E: GET (DD1, DD2)-STEP(29, 20), DD: GOTO 33
45 EE1 = D: EE2 = E: GET (EE1, EE2)-STEP(29, 20), EE: GOTO 33
46 FF1 = D: FF2 = E: GET (FF1, FF2)-STEP(29, 20), FF: GOTO 33
47 GG1 = D: GG2 = E: GET (GG1, GG2)-STEP(29, 20), GG: GOTO 33
48 HH1 = D: HH2 = E: GET (HH1, HH2)-STEP(29, 20), HH: GOTO 33
49 II1 = D: II2 = E: GET (II1, II2)-STEP(29, 20), II: GOTO 33
50 JJ1 = D: JJ2 = E: GET (JJ1, JJ2)-STEP(29, 20), JJ: GOTO 33
51 KK1 = D: KK2 = E: GET (KK1, KK2)-STEP(29, 20), KK: GOTO 33
52 LL1 = D: LL2 = E: GET (LL1, LL2)-STEP(29, 20), LL: GOTO 33
53 MM1 = D: MM2 = E: GET (MM1, MM2)-STEP(29, 20), MM: GOTO 33
54 NN1 = D: NN2 = E: GET (NN1, NN2)-STEP(29, 20), NN: GOTO 33
55 OO1 = D: OO2 = E: GET (OO1, OO2)-STEP(29, 20), OO: GOTO 33
33 I3(W) = XX1: I4(W) = YY1
IF XX1 > 0 THEN I(XX1, YY1) = W ELSE I1(ABS(XX1), YY1) = W
IF YY1 MOD 2 = 1 AND XX1 MOD 2 = 1 THEN 63
IF YY1 MOD 2 = 1 AND XX1 MOD 2 = -1 THEN 63
IF YY1 MOD 2 = 0 AND XX1 MOD 2 = 0 THEN 63 ELSE 74
63 GOSUB 333: PUT (x, Y), Q1, PSET: GOTO 111
74 RETURN 1
111 IF Y > 333 THEN PUT (x, Y), Q12: W = 0: GOTO 32 ELSE
IF Y > 296 THEN v = x: P = Y: GOSUB 67: W = 0: GOTO 32 ELSE
IF Y < 296 THEN v = x: P = Y: GOSUB 67: W = 0: GOTO 32 ELSE
32 IF SET1 = XX1 AND SET2 = YY1 THEN RETURN 1
A1: PUT (x, Y), Q1, PSET
XX5 = XX1: YY5 = YY1: X5 = x: Y5 = Y
XX1 = 5: YY1 = 3: x = 402: Y = 283
GET (x, Y)-STEP(20, 20), Q1: v = x: P = Y: GOSUB 67
RETURN 90
56 IF XX1 = I3(1) AND YY1 = I4(1) THEN  ELSE 471
PUT (AA1, AA2), AA, PSET: W = 1: PUT (x, Y), Q1, PSET: GOSUB 116
471 IF XX1 = I3(2) AND YY1 = I4(2) THEN  ELSE 472
PUT (BB1, BB2), BB, PSET: W = 2: PUT (x, Y), Q1, PSET: GOSUB 116
472 IF XX1 = I3(3) AND YY1 = I4(3) THEN  ELSE 473
PUT (CC1, CC2), CC, PSET: W = 3: PUT (x, Y), Q1, PSET: GOSUB 116
473 IF XX1 = I3(4) AND YY1 = I4(4) THEN  ELSE 474
PUT (DD1, DD2), DD, PSET: W = 4: PUT (x, Y), Q1, PSET: GOSUB 116
474 IF XX1 = I3(5) AND YY1 = I4(5) THEN  ELSE 475
PUT (EE1, EE2), EE, PSET: W = 5: PUT (x, Y), Q1, PSET: GOSUB 116
475 IF XX1 = I3(6) AND YY1 = I4(6) THEN  ELSE 476
PUT (FF1, FF2), FF, PSET: W = 6: PUT (x, Y), Q1, PSET: GOSUB 116
476 IF XX1 = I3(7) AND YY1 = I4(7) THEN  ELSE 477
PUT (GG1, GG2), GG, PSET: W = 7: PUT (x, Y), Q1, PSET: GOSUB 116
477 IF XX1 = I3(8) AND YY1 = I4(8) THEN  ELSE 478
PUT (HH1, HH2), HH, PSET: W = 8: PUT (x, Y), Q1, PSET: GOSUB 116
478 IF XX1 = I3(9) AND YY1 = I4(9) THEN  ELSE 479
PUT (II1, II2), II, PSET: W = 9: PUT (x, Y), Q1, PSET: GOSUB 116
479 IF XX1 = I3(10) AND YY1 = I4(10) THEN  ELSE 351
PUT (JJ1, JJ2), JJ, PSET: W = 10: PUT (x, Y), Q1, PSET: GOSUB 116
351 IF XX1 = I3(11) AND YY1 = I4(11) THEN  ELSE 352
PUT (KK1, KK2), KK, PSET: W = 11: PUT (x, Y), Q1, PSET: GOSUB 116
352 IF XX1 = I3(12) AND YY1 = I4(12) THEN  ELSE 353
PUT (LL1, LL2), LL, PSET: W = 12: PUT (x, Y), Q1, PSET: GOSUB 116
353 IF XX1 = I3(13) AND YY1 = I4(13) THEN  ELSE 354
PUT (MM1, MM2), MM, PSET: W = 13: PUT (x, Y), Q1, PSET: GOSUB 116
354 IF XX1 = I3(14) AND YY1 = I4(14) THEN  ELSE 355
PUT (NN1, NN2), NN, PSET: W = 14: PUT (x, Y), Q1, PSET: GOSUB 116
355 IF XX1 = I3(15) AND YY1 = I4(15) THEN  ELSE RETURN
PUT (OO1, OO2), OO, PSET: W = 15: PUT (x, Y), Q1, PSET: GOSUB 116
116 SET1 = XX1: SET2 = YY1
IF Y > 325 THEN PUT (x, Y), Q12: RETURN 23 ELSE
IF Y < 325 THEN v = x: P = Y: GOSUB 67: RETURN 23 ELSE
RETURN
23 IF XX1 > 0 THEN I(XX1, YY1) = 0 ELSE I1(ABS(XX1), YY1) = 0
X3 = XX1: Y3 = YY1
RETURN
90 IF ZS = 0 THEN GOSUB CHO
PUT (80, 20), TEXT
HAB = 0: H = 0: B = 0: D = -10
IF N >= 5 THEN 293
SLEEP (1)
N = N + 1: H = 1
IF N = 1 THEN HAB = 1: CJ3(0, 1) = -4: CJ4(0, 1) = 12: WAY2(1, 1, 2) = -1: WAY1(1, 1, 1) = -3: WAY2(1, 1, 1) = 11: GOTO SD1
IF N = 2 THEN HAB = 10: CJ3(0, 10) = -2: CJ4(0, 10) = 14: WAY2(10, 1, 3) = -1: WAY1(10, 1, 1) = -4: WAY2(10, 1, 1) = 12: WAY1(10, 1, 2) = -2: WAY2(10, 1, 2) = 10: GOTO SD1
IF N = 3 THEN HAB = 3: CJ3(0, 3) = 0: CJ4(0, 3) = 12: WAY2(3, 1, 2) = -1: WAY1(3, 1, 1) = 1: WAY2(3, 1, 1) = 11: GOTO SD1 ELSE
IF N = 5 THEN HAB = 15: CJ3(0, 15) = 0: CJ4(0, 15) = 16: WAY2(15, 1, 4) = -1: WAY1(15, 1, 1) = -2: WAY2(15, 1, 1) = 14: WAY1(15, 1, 2) = 0: WAY2(15, 1, 2) = 12: WAY1(15, 1, 3) = 2: WAY2(15, 1, 3) = 10: GOTO SD1
IF N = 4 THEN HAB = 8: CJ3(0, 8) = 1: CJ4(0, 8) = 13: WAY2(8, 1, 4) = -1: WAY1(8, 1, 1) = 3: WAY2(8, 1, 1) = 11: WAY1(8, 1, 2) = -1: WAY2(8, 1, 2) = 11: WAY1(8, 1, 3) = -3: WAY2(8, 1, 3) = 9: GOTO SD1
293 kl = 0: B4 = 0: B6 = 0
GOSUB SP
JIN = 1: GOSUB 294: ERASE BY1, BY2
IF ABS(B) < 7.3 THEN B = 0: GOTO 295
FOR E = 1 TO 13:
IF WAY2(F1(1), F2(1), E + 1) = -1 THEN 296
FOR O = 1 TO B3: O1 = 0: DO
O1 = O1 + 1
IF WAY1(F1(1), F2(1), E) = WAY1(F1(O), F2(O), O1) THEN  ELSE 3
IF WAY2(F1(1), F2(1), E) = WAY2(F1(O), F2(O), O1) THEN 39
3 LOOP UNTIL WAY2(F1(O), F2(O), O1 + 1) = -1: IO = 1: O1 = 0
39 NEXT O
IF IO <> 1 THEN  ELSE IO = 0: GOTO 296
kl = kl + 1: BY1(kl) = WAY1(F1(1), F2(1), E): BY2(kl) = WAY2(F1(1), F2(1), E)
296 NEXT E
IF kl < 1 THEN B4 = 1 ELSE B = ABS(B)
295 HAB = 0
ERASE CHY, CHX, WAY1, WAY2, M, FHX, FHY, CJ3, CJ4, CB, F1, F2: B3 = 0
GOSUB SP
B = B - 2: HA1 = 0: H3 = 0: B5 = 0: GOSUB 294
B3 = 0: ERASE F1, F2
IF HAB <> 0 THEN GOTO SD1
IF HAB = 0 AND B4 = 1 THEN HAB = HA1: H = H3: GOTO SD1
FOR R = 1 TO kl
FOR R1 = 1 TO 15: FOR E = 1 TO 45: IF CHY(R1, E) = -100 THEN 289
G = 0: DO: G = G + 1
IF G = 14 THEN WAY2(R1, E, G) = -1: GOTO 297
IF WAY2(R1, E, G) <> -1 THEN 297
IF BY1(R) = WAY1(R1, E, G - 1) AND BY2(R) = WAY2(R1, E, G - 1) THEN  ELSE 297
IF CHY(R1, E) > 0 THEN B3 = B3 + 1: F1(B3) = R1: F2(B3) = E
297 LOOP UNTIL WAY2(R1, E, G) = -1
NEXT E
289 NEXT R1
NEXT R
B = B + 2
GOSUB SP: B7 = B: B9 = B
C3 = B3
FOR U = 1 TO C3 STEP 1: FOR I = 1 TO 13
IF WAY2(F1(U), F2(U), I) <> -1 THEN 497
BK = WAY1(F1(U), F2(U), I - 1): BJ = WAY2(F1(U), F2(U), I - 1)
IF BK > 0 THEN I(BK, BJ) = F1(U) ELSE I1(ABS(BK), BJ) = F1(U)
BK1 = I3(F1(U)): BJ1 = I4(F1(U))
IF BK1 > 0 THEN I(BK1, BJ1) = 0 ELSE I1(ABS(BK1), BJ1) = 0
I3(F1(U)) = BK: I4(F1(U)) = BJ: B8 = 0: RT = 1: B3 = 0: L = 1: L1 = 1: FG = 0
CI = F1(U): Z1 = 0: CX = 0: ZE = 1
ERASE DJ3, DJ4, SHY, SHX, SJ3, SJ4, SM, SFX, SFY: GOSUB S91
IF EW3 <> 0 THEN B8 = B8 - CHY(F1(U), F2(U))
ZE = 0: RT = 0: IF B8 <= B9 THEN HAB = EW3: H = EW4: B9 = B8
I3(F1(U)) = BK1: I4(F1(U)) = BJ1
IF BK > 0 THEN I(BK, BJ) = 0 ELSE I1(ABS(BK), BJ) = 0
IF BK1 > 0 THEN I(BK1, BJ1) = F1(U) ELSE I1(ABS(BK1), BJ1) = F1(U)
497 NEXT I, U
GOSUB SP
198 ERASE F1, F2: IF HAB <> 0 THEN GOTO SD1
HAB = HA1: H = H3: GOTO SD1
294 LOCATE 1, 1: BE = 0: CU = 0: D = -10: ERASE CB
FOR CI = 15 TO 1 STEP -1
CN = 0: M = 0: RE = 0: R = 1: WWN = 0: CHX(CI, 1) = J3(CI): L = 1: DE = 100
CJ3(0, CI) = J3(CI): CJ4(0, CI) = J4(CI): FHX(CI, 0) = J3(CI): FG = 0
ERASE WAY3, WAY4, STE
91 IF M(RE) = 1 THEN GOTO S4 ELSE
CK = J3(CI) + 2: CJ = J4(CI)
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB 910 ELSE GOTO S4
IF CK > 0 THEN GOTO S4
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB 910
S4: IF M(RE) = 2 THEN GOTO S3 ELSE
CK = J3(CI) - 2: CJ = J4(CI)
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB 920 ELSE GOTO S3
IF CK > 0 THEN GOTO S3
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB 920
S3: IF M(RE) = 3 THEN GOTO S2 ELSE
CK = J3(CI) + 1: CJ = J4(CI) + 1
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB 930 ELSE GOTO S2
IF CK > 0 THEN GOTO S2
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB 930
S2: IF M(RE) = 4 THEN GOTO S1 ELSE
CK = J3(CI) + 1: CJ = J4(CI) - 1: IF CJ <= 0 THEN GOTO S1
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB 940 ELSE GOTO S1
IF CK > 0 THEN GOTO S1
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB 940
S1: IF M(RE) = 5 THEN GOTO s ELSE
CK = J3(CI) - 1: CJ = J4(CI) + 1
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB 950 ELSE GOTO s
IF CK > 0 THEN GOTO s
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB 950
s: IF M(RE) = 6 THEN 87 ELSE
CK = J3(CI) - 1: CJ = J4(CI) - 1: IF CJ <= 0 THEN 87
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB 960 ELSE 87
IF CK > 0 THEN GOTO 87
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB 960
87 WAY2(CI, R, CN + 1) = -1
IF RE > 0 THEN  ELSE 77
IF J3(CI) > 0 THEN J(J3(CI), J4(CI)) = 0 ELSE J1(ABS(J3(CI)), J4(CI)) = 0
IF CHY(CI, R) < CB(CI) THEN CB(CI) = CHY(CI, R)
R = R + 1: DX = DX + 1: DJ1(DX) = J3(CI): DJ2(DX) = J4(CI): DE = RE - 1: STE(DX) = CN
NUM(DX) = R - 1
221 RE = RE - 1
IF WWN = 1 THEN WWN = 0: CHY(CI, R) = 0: CHX(CI, R) = CJ3(0, CI): GOTO Q
CHY(CI, R) = FHY(CI, RE): CHX(CI, R) = FHX(CI, RE)
Q: CN = CN - 1
FOR I = 1 TO CN: WAY1(CI, R, I) = WAY1(CI, R - 1, I)
WAY2(CI, R, I) = WAY2(CI, R - 1, I): NEXT I
RETURN
77 IF JIN = 1 THEN 78
IF FG = 1 THEN FG = 0: GOTO 78
CK = CJ3(0, CI) + 2: CJ = CJ4(0, CI)
IF CK > 0 THEN IF I(CK, CJ) = 0 AND J(CK, CJ) = 0 THEN 19 ELSE GOTO A78
IF I1(ABS(CK), CJ) = 0 AND J1(ABS(CK), CJ) = 0 THEN 19 ELSE GOTO A78
19 IF CK - 2 > 0 THEN J(CK - 2, CJ) = 0 ELSE J1(ABS(CK - 2), CJ) = 0
R = R + 1: CHY(CI, R) = 0: CHX(CI, R) = CK: SM(0) = 2
IF wh > 50 THEN OK = 0 ELSE OK = 1
GOSUB OK
A78: IF FG = 1 THEN FG = 0: GOTO 78
CK = CJ3(0, CI) - 2: CJ = CJ4(0, CI)
IF CK > 0 THEN IF I(CK, CJ) = 0 AND J(CK, CJ) = 0 THEN 129 ELSE GOTO B78
IF I1(ABS(CK), CJ) = 0 AND J1(ABS(CK), CJ) = 0 THEN 129 ELSE GOTO B78
129 IF CK + 2 > 0 THEN J(CK + 2, CJ) = 0 ELSE J1(ABS(CK + 2), CJ) = 0
R = R + 1: CHY(CI, R) = 0: CHX(CI, R) = CK: SM(0) = 1
IF wh > 50 THEN OK = 0 ELSE OK = 1
GOSUB OK
B78: IF FG = 1 THEN FG = 0: GOTO 78
CK = CJ3(0, CI) + 1: CJ = CJ4(0, CI) + 1
IF CK > 0 THEN IF I(CK, CJ) = 0 AND J(CK, CJ) = 0 THEN 229 ELSE GOTO C78
IF I1(ABS(CK), CJ) = 0 AND J1(ABS(CK), CJ) = 0 THEN 229 ELSE GOTO C78
229 IF CK - 1 > 0 THEN J(CK - 1, CJ - 1) = 0 ELSE J1(ABS(CK - 1), CJ - 1) = 0
R = R + 1: CHY(CI, R) = -1: CHX(CI, R) = CK: OK = 1: SM(0) = 6
GOSUB OK
C78: IF FG = 1 THEN FG = 0: GOTO 78
CK = CJ3(0, CI) + 1: CJ = CJ4(0, CI) - 1: IF CJ <= 0 THEN GOTO D78
IF CK > 0 THEN IF I(CK, CJ) = 0 AND J(CK, CJ) = 0 THEN 329 ELSE GOTO D78
IF I1(ABS(CK), CJ) = 0 AND J1(ABS(CK), CJ) = 0 THEN 329 ELSE GOTO D78
329 IF CK - 1 > 0 THEN J(CK - 1, CJ + 1) = 0 ELSE J1(ABS(CK - 1), CJ + 1) = 0
R = R + 1: CHY(CI, R) = 1: CHX(CI, R) = CK: SM(0) = 5
GOSUB OK
D78: IF FG = 1 THEN FG = 0: GOTO 78
CK = CJ3(0, CI) - 1: CJ = CJ4(0, CI) + 1
IF CK > 0 THEN IF I(CK, CJ) = 0 AND J(CK, CJ) = 0 THEN 429 ELSE GOTO E78
IF I1(ABS(CK), CJ) = 0 AND J1(ABS(CK), CJ) = 0 THEN 429 ELSE GOTO E78
429 IF CK + 1 > 0 THEN J(CK + 1, CJ - 1) = 0 ELSE J1(ABS(CK + 1), CJ - 1) = 0
R = R + 1: CHY(CI, R) = -1: CHX(CI, R) = CK: OK = 1: SM(0) = 4
GOSUB OK
E78: IF FG = 1 THEN FG = 0: GOTO 78
CK = CJ3(0, CI) - 1: CJ = CJ4(0, CI) - 1
IF CJ <= 0 THEN GOTO 78
IF CK > 0 THEN IF I(CK, CJ) = 0 AND J(CK, CJ) = 0 THEN 529 ELSE GOTO 78
IF I1(ABS(CK), CJ) = 0 AND J1(ABS(CK), CJ) = 0 THEN 529 ELSE GOTO 78
529 IF CK + 1 > 0 THEN J(CK + 1, CJ + 1) = 0 ELSE J1(ABS(CK + 1), CJ + 1) = 0
R = R + 1: CHY(CI, R) = 1: CHX(CI, R) = CK: SM(0) = 3
GOSUB OK
78 CHY(CI, R + 1) = -100: FG = 0
IF J3(CI) > 0 THEN J(J3(CI), J4(CI)) = 0 ELSE J1(ABS(J3(CI)), J4(CI)) = 0
J3(CI) = CJ3(RE, CI): J4(CI) = CJ4(RE, CI)
IF J3(CI) > 0 THEN J(J3(CI), J4(CI)) = CI ELSE J1(ABS(J3(CI)), J4(CI)) = CI
DX = 0: ERASE DJ1, DJ2
NEXT CI:
99 SE = 0: SE1 = 0
FOR I = 0 TO 16: FOR J = 15 TO 1 STEP -1
IF JIN = 0 AND J4(J) = I THEN  ELSE 8
IF J3(J) > 0 THEN WC = J(J3(J), J4(J)) ELSE WC = J1(ABS(J3(J)), J4(J))
GOSUB WS
8 IF JIN = 1 AND J4(J) = I THEN  ELSE 9
IF J3(J) > 0 THEN WC = J(J3(J), J4(J)) ELSE WC = J1(ABS(J3(J)), J4(J))
GOSUB W1
9 NEXT J, I: b2 = 0: D = -100: EW1 = 0: EW2 = 0
IF JIN = 1 THEN RETURN
B = B + 2
IF CB(HA1) > 0 THEN B = B - CB(HA1)
GOSUB SP: JIN = 2: B7 = B: B9 = B: C3 = B3
IF B3 = 0 THEN C3 = 1: F1(1) = HA1: F2(1) = H3
FOR U = 1 TO C3 STEP 1: FOR I = 1 TO 13
IF WAY2(F1(U), F2(U), I) <> -1 THEN 597
BK = WAY1(F1(U), F2(U), I - 1): BJ = WAY2(F1(U), F2(U), I - 1)
IF BK > 0 THEN I(BK, BJ) = F1(U) ELSE I1(ABS(BK), BJ) = F1(U)
BK1 = I3(F1(U)): BJ1 = I4(F1(U))
IF BK1 > 0 THEN I(BK1, BJ1) = 0 ELSE I1(ABS(BK1), BJ1) = 0
I3(F1(U)) = BK: I4(F1(U)) = BJ: B8 = 0: RT = 2: B3 = 0: L = 1: L1 = 1: FG = 0
CI = F1(U): Z1 = 0: CX = 0: ZE = 1: JIN = 2
ERASE DJ3, DJ4, SHY, SHX, SJ3, SJ4, SM, SFX, SFY: GOSUB S91
IF EW3 <> 0 THEN B8 = B8 - CHY(F1(U), F2(U))
ZE = 0: RT = 0: IF B8 <= B9 THEN B9 = B8
I3(F1(U)) = BK1: I4(F1(U)) = BJ1
IF BK > 0 THEN I(BK, BJ) = 0 ELSE I1(ABS(BK), BJ) = 0
IF BK1 > 0 THEN I(BK1, BJ1) = F1(U) ELSE I1(ABS(BK1), BJ1) = F1(U)
597 NEXT I, U
GOSUB SP: B = B - 2
IF JK = 1 THEN JK = 0: B3 = 0: HAB = 0: HA1 = 0: H = 0: H3 = 0: B5 = 0: GOTO 99
IF C3 < 2 OR CHY(HA1, H3) < 3 THEN 98
FOR U = 1 TO C3 STEP 1: FOR I = 1 TO 13
IF WAY2(F1(U), F2(U), I) <> -1 THEN 97
BK = WAY1(F1(U), F2(U), I - 1): BJ = WAY2(F1(U), F2(U), I - 1)
IF BK > 0 THEN J(BK, BJ) = F1(U) ELSE J1(ABS(BK), BJ) = F1(U)
BK1 = J3(F1(U)): BJ1 = J4(F1(U))
IF BK1 > 0 THEN J(BK1, BJ1) = 0 ELSE J1(ABS(BK1), BJ1) = 0
J3(F1(U)) = BK: J4(F1(U)) = BJ: B3 = 0: L = 1: L1 = 1: FG = 0: CI = F1(U)
Z1 = 0: CX = 0: ZE = 1: ERASE DJ3, DJ4, SHY, SHX, SJ3, SJ4, SM, SFX, SFY
GOSUB S91: ZE = 0
J3(F1(U)) = BK1: J4(F1(U)) = BJ1
IF BK > 0 THEN J(BK, BJ) = 0 ELSE J1(ABS(BK), BJ) = 0
IF BK1 > 0 THEN J(BK1, BJ1) = F1(U) ELSE J1(ABS(BK1), BJ1) = F1(U)
97 NEXT I, U
IF EW1 = 0 THEN HAB = HA1: H = H3 ELSE HAB = EW1: H = EW2
98 ERASE F1, F2: GOTO 10
WS: CB(WC) = CB(WC) - 1
SE = SE + 1: IF SE = 14 THEN SE1 = J4(WC)
IF wh > 113 AND wh < 160 THEN SI = WC: L1 = 0: GOSUB OO1 ELSE CB(WC) = 0
IF wh > 113 AND wh < 160 THEN IF L1 = 1 THEN IF CB(WC) < 0 THEN CB(WC) = 0
IF CB(WC) > -3 AND CB(WC) < 1 THEN CB(WC) = 0
IF SE > 10 AND wh > 113 AND wh < 169 THEN CB(WC) = CB(WC) + 1
IF SE > 10 AND wh > 169 THEN CB(WC) = CB(WC) + 2
IF SE = 15 THEN CB(WC) = CB(WC) + J4(WC) - SE1
IF SE = 15 AND wh > 189 THEN CB(WC) = CB(WC) + 4
FOR CR = 1 TO 45
HY = CHY(WC, CR): HX = ABS(CHX(WC, CR))
IF HY = -100 THEN RETURN
IF HY <= 0 THEN GOTO QS
HY = HY + J4(WC) / 4 + CB(WC)
IF HY >= B5 AND HX < 6 THEN HA1 = WC: H3 = CR: B5 = HY
IF HY > B AND HX < 6 THEN B3 = 0: B3 = B3 + 1: F1(B3) = WC: F2(B3) = CR
IF HY > B AND HX < 6 THEN HAB = WC: H = CR: B = HY: D = HX: GOTO QS
IF HY = B AND HX = D AND HX < ABS(CHX(HAB, H)) THEN B3 = B3 + 1 ELSE 6
F1(B3) = WC: F2(B3) = CR: HAB = WC: H = CR: B = HY: D = HX: GOTO QS
6 IF HY = B AND HX <= ABS(D) AND HX < 6 THEN HAB = WC: H = CR: B3 = B3 + 1: F1(B3) = WC
IF HY = B AND HX <= ABS(D) AND HX < 6 THEN F2(B3) = CR: B = HY: D = HX: GOTO QS
QS: NEXT CR
W1: FOR CR = 1 TO 45
HY = CHY(WC, CR): HX = ABS(CHX(WC, CR))
IF HY = -100 THEN RETURN
IF HY > 0 THEN GOTO Q1
HY = HY - (16 - J4(WC)) / 4
IF HY < B AND HX < 6 THEN B3 = 0: B3 = B3 + 1: F1(B3) = WC: F2(B3) = CR
IF HY < B AND HX < 6 THEN HAB = WC: H = CR: B = HY: D = CHX(WC, CR): GOTO Q1
IF HY = B AND HX = D THEN IF HX < ABS(CHX(HAB, H)) THEN  ELSE 16 ELSE 16
B3 = B3 + 1
F1(B3) = WC: F2(B3) = CR: HAB = WC: H = CR: B = HY: D = CHX(WC, CR): GOTO Q1
16 IF HY = B AND HX <= ABS(D) THEN HAB = WC: H = CR: B3 = B3 + 1: F1(B3) = WC
IF HY = B AND HX <= ABS(D) THEN F2(B3) = CR: B = HY: D = CHX(WC, CR): GOTO Q1
Q1: NEXT CR
10 IF wh > 60 THEN GOSUB CK
RETURN
SD1: LINE (80, 10)-STEP(100, 25), 0, BF
FOR CR = 1 TO 13
FOR I = 1 TO 2
IF CR = 1 THEN GOSUB 83 ELSE 84
NEXT I: GOTO 84
83 WX = FNF(CJ3(0, HAB)): WY = FNQ(CJ4(0, HAB))
D = WX: E = WY
BS = 1
ON HAB GOSUB H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15
BS = 0
RETURN
84 IF WAY2(HAB, H, CR) = -1 THEN 1111
WX = FNF(WAY1(HAB, H, CR)): WY = FNQ((WAY2(HAB, H, CR))): D = WX: E = WY
SLEEP (1)
ZS: ON HAB GOSUB H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15
NEXT CR
GOTO 1111
H1: PUT (AA4, AA5), AA3, PSET: GET (WX, WY)-STEP(29, 19), AA3: GOSUB 334
AA4 = WX: AA5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), AA3, PSET: RETURN ELSE RETURN
H2: PUT (BB4, BB5), BB3, PSET: GET (WX, WY)-STEP(29, 19), BB3: GOSUB 334
BB4 = WX: BB5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), BB3, PSET: RETURN ELSE RETURN
H3: PUT (CC4, CC5), CC3, PSET: GET (WX, WY)-STEP(29, 19), CC3: GOSUB 334
CC4 = WX: CC5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), CC3, PSET: RETURN ELSE RETURN
H4: PUT (DD4, DD5), DD3, PSET: GET (WX, WY)-STEP(29, 19), DD3: GOSUB 334
DD4 = WX: DD5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), DD3, PSET: RETURN ELSE RETURN
H5: PUT (EE4, EE5), EE3, PSET: GET (WX, WY)-STEP(29, 19), EE3: GOSUB 334
EE4 = WX: EE5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), EE3, PSET: RETURN ELSE RETURN
H6: PUT (FF4, FF5), FF3, PSET: GET (WX, WY)-STEP(29, 19), FF3: GOSUB 334
FF4 = WX: FF5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), FF3, PSET: RETURN ELSE RETURN
H7: PUT (GG4, GG5), GG3, PSET: GET (WX, WY)-STEP(29, 19), GG3: GOSUB 334
GG4 = WX: GG5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), GG3, PSET: RETURN ELSE RETURN
H8: PUT (HH4, HH5), HH3, PSET: GET (WX, WY)-STEP(29, 19), HH3: GOSUB 334
HH4 = WX: HH5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), HH3, PSET: RETURN ELSE RETURN
H9: PUT (II4, II5), II3, PSET: GET (WX, WY)-STEP(29, 19), II3: GOSUB 334
II4 = WX: II5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), II3, PSET: RETURN ELSE RETURN
H10: PUT (JJ4, JJ5), JJ3, PSET: GET (WX, WY)-STEP(29, 19), JJ3: GOSUB 334
JJ4 = WX: JJ5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), JJ3, PSET: RETURN ELSE RETURN
H11: PUT (KK4, KK5), KK3, PSET: GET (WX, WY)-STEP(29, 19), KK3: GOSUB 334
KK4 = WX: KK5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), KK3, PSET: RETURN ELSE RETURN
H12: PUT (LL4, LL5), LL3, PSET: GET (WX, WY)-STEP(29, 19), LL3: GOSUB 334
LL4 = WX: LL5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), LL3, PSET: RETURN ELSE RETURN
H13: PUT (MM4, MM5), MM3, PSET: GET (WX, WY)-STEP(29, 19), MM3: GOSUB 334
MM4 = WX: MM5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), MM3, PSET: RETURN ELSE RETURN
H14: PUT (NN4, NN5), NN3, PSET: GET (WX, WY)-STEP(29, 19), NN3: GOSUB 334
NN4 = WX: NN5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), NN3, PSET: RETURN ELSE RETURN
H15: PUT (OO4, OO5), OO3, PSET: GET (WX, WY)-STEP(29, 19), OO3: GOSUB 334
OO4 = WX: OO5 = WY
IF BS = 1 THEN SLEEP (1): PUT (WX, WY), OO3, PSET: RETURN ELSE RETURN
1111 J3(HAB) = WAY1(HAB, H, CR - 1): J4(HAB) = WAY2(HAB, H, CR - 1)
SSD: C3 = CJ3(0, HAB): C4 = CJ4(0, HAB)
IF C3 > 0 THEN J(C3, C4) = 0 ELSE J1(ABS(C3), C4) = 0
IF J3(HAB) > 0 THEN J(J3(HAB), J4(HAB)) = HAB: GOTO 156
J1(ABS(J3(HAB)), J4(HAB)) = HAB
156 ERASE CHY, CHX, WAY1, WAY2, M, FHX, FHY, CJ3, CJ4, CB
GOSUB CHO: b2 = 0: IF CR = 2 THEN FS = HAB ELSE FS = 0
PUT (x, Y), Q1, PSET
XX1 = XX5: YY1 = YY5: x = X5: Y = Y5
GET (x, Y)-STEP(20, 20), Q1: v = x: P = Y: GOSUB 67
GOTO 1
910 CK1 = CK + 2: CJ1 = CJ: IF CHY(CI, R) < 6 THEN 710
IF CK1 > 0 THEN IF I(CK1, CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
710 IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 911 ELSE RETURN S4
IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 911 ELSE RETURN S4
911 GOSUB GG
IF CK - 2 > 0 THEN J(CK - 2, CJ) = 0 ELSE J1(ABS(CK - 2), CJ) = 0
CN = CN + 1: CHY(CI, R) = CHY(CI, R): CHX(CI, R) = CHX(CI, R) + 4
GOSUB GG2: M(RE) = 2: GOSUB 91: GOSUB E: RETURN S4
920 CK1 = CK - 2: CJ1 = CJ: IF CHY(CI, R) < 6 THEN 720
IF CK1 > 0 THEN IF I(CK1, CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
720 IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 921 ELSE RETURN S3
IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 921 ELSE RETURN S3
921 GOSUB GG
IF CK + 2 > 0 THEN J(CK + 2, CJ) = 0 ELSE J1(ABS(CK + 2), CJ) = 0
CN = CN + 1: CHY(CI, R) = CHY(CI, R): CHX(CI, R) = CHX(CI, R) - 4
GOSUB GG2: M(RE) = 1
GOSUB 91: GOSUB E: RETURN S3
930 CK1 = CK + 1: CJ1 = CJ + 1: IF CHY(CI, R) <= 8 THEN 730
IF CK1 > 0 THEN IF I(CK1, CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
730 IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 931 ELSE RETURN S2
IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 931 ELSE RETURN S2
931 GOSUB GG
IF CK - 1 > 0 THEN J(CK - 1, CJ - 1) = 0 ELSE J1(ABS(CK - 1), CJ - 1) = 0
CN = CN + 1: CHY(CI, R) = CHY(CI, R) - 2: CHX(CI, R) = CHX(CI, R) + 2
GOSUB GG2: M(RE) = 6
GOSUB 91: GOSUB E: RETURN S2
940 CK1 = CK + 1: CJ1 = CJ - 1: IF CHY(CI, R) < 6 THEN 740
IF CK1 > 0 THEN IF I(CK1, CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
740 IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 941 ELSE RETURN S1
IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 941 ELSE RETURN S1
941 GOSUB GG
IF CK - 1 > 0 THEN J(CK - 1, CJ + 1) = 0 ELSE J1(ABS(CK - 1), CJ + 1) = 0
CN = CN + 1: CHY(CI, R) = CHY(CI, R) + 2: CHX(CI, R) = CHX(CI, R) + 2
GOSUB GG2: M(RE) = 5
GOSUB 91: GOSUB E: RETURN S1
950 CK1 = CK - 1: CJ1 = CJ + 1: IF CHY(CI, R) <= 8 THEN 750
IF CK1 > 0 THEN IF I(CK1, CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
750 IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 951 ELSE RETURN s
IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 951 ELSE RETURN s
951 GOSUB GG
IF CK + 1 > 0 THEN J(CK + 1, CJ - 1) = 0 ELSE J1(ABS(CK + 1), CJ - 1) = 0
CN = CN + 1: CHY(CI, R) = CHY(CI, R) - 2: CHX(CI, R) = CHX(CI, R) - 2
GOSUB GG2: M(RE) = 4
GOSUB 91: GOSUB E: RETURN s
960 CK1 = CK - 1: CJ1 = CJ - 1: IF CHY(CI, R) < 6 THEN 760
IF CK1 > 0 THEN IF I(CK1, CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) > 0 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 87
760 IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 961 ELSE RETURN 87
IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 961 ELSE RETURN 87
961 GOSUB GG
IF CK + 1 > 0 THEN J(CK + 1, CJ + 1) = 0 ELSE J1(ABS(CK + 1), CJ + 1) = 0
CN = CN + 1: CHY(CI, R) = CHY(CI, R) + 2: CHX(CI, R) = CHX(CI, R) - 2
GOSUB GG2: M(RE) = 3
GOSUB 91: GOSUB E: RETURN 87
333 CIRCLE (D + 13, E + 10), 11, 7: PAINT (D + 13, E + 10), 12, 7
CIRCLE (D + 13, E + 10), 11, 4: CIRCLE (D + 13, E + 10), 8, 4
CIRCLE (D + 13, E + 10), 9, 15, .9, 3.7: CIRCLE (D + 13, E + 10), 6, 15, 1.1, 3.5
CIRCLE (D + 13, E + 10), 2, 15, 1.2, 3.5
CIRCLE (D + 13, E + 10), 7, 4: CIRCLE (D + 13, E + 10), 3, 4: RETURN
334 CIRCLE (D + 13, E + 10), 11, 7: PAINT (D + 13, E + 10), 3, 7
CIRCLE (D + 13, E + 10), 11, 1: CIRCLE (D + 13, E + 10), 8, 1
CIRCLE (D + 13, E + 10), 9, 15, .9, 3.7: CIRCLE (D + 13, E + 10), 6, 15, 1.1, 3.5
CIRCLE (D + 13, E + 10), 2, 15, 1.2, 3.5
CIRCLE (D + 13, E + 10), 7, 1: CIRCLE (D + 13, E + 10), 3, 1: RETURN

CK: CS = 0: FOR I = 12 TO 16: FOR J = -4 TO 4
IF J > 0 THEN IF J(J, I) = 0 AND I(J, I) = 0 THEN CS = CS + 1
IF J < 1 THEN IF J1(ABS(J), I) = 0 AND I1(ABS(J), I) = 0 THEN CS = CS + 1
NEXT J, I: IF CS = 0 THEN LOSE = 1
FOR B1 = 15 TO 1 STEP -1: IF J4(B1) > 5 THEN RETURN
NEXT B1
ZS = 0: FOR I = 0 TO 4: FOR J = -4 TO 4
IF J > 0 THEN IF J(J, I) = 0 AND I(J, I) = 0 THEN ZS = ZS + 1 ELSE 29 ELSE 29
D1(ZS) = J: B1(ZS) = I
29 IF J < 1 THEN  ELSE 34
IF J1(ABS(J), I) = 0 AND I1(ABS(J), I) = 0 THEN  ELSE 34
ZS = ZS + 1: D1(ZS) = J: B1(ZS) = I
34 NEXT J, I: IF ZS = 0 THEN WIN = 1
IF CHECK = 1 THEN CHECK = 0: RETURN
B9 = 0: MUL = 0: MU = 0
FOR I = 0 TO 8 STEP 1
FOR J = 0 TO 7 STEP 1
IF J1(ABS(J), I) > 0 THEN WC = J1(ABS(J), I): GOSUB WS1
IF J(ABS(J), I) > 0 THEN WC = J(ABS(J), I): GOSUB WS1
NEXT J, I:
IF MUL <> 0 THEN HAB = MUL: H = MU
AB = HAB
RETURN SD1
WS1: IF WC = AB THEN RETURN
FOR SA = ZS TO 1 STEP -1
FOR CR = 1 TO 45: FOR F1 = 1 TO 13
IF WAY2(WC, CR, F1) = -1 THEN GOTO G1
IF CHY(WC, CR) = -100 THEN GOTO G2 ELSE
IF WAY2(WC, CR, F1) = B1(SA) AND WAY1(WC, CR, F1) = D1(SA) THEN  ELSE GOTO QS1
IF CHY(WC, CR) >= B9 THEN  ELSE GOTO QS1
MUL = 0: MU = 0
IF J3(WC) - 1 > 0 THEN IF J(J3(WC) - 1, J4(WC) + 1) > 0 THEN MUL = WC: MU = CR
IF J3(WC) - 1 < 1 THEN IF J1(ABS(J3(WC) - 1), J4(WC) + 1) > 0 THEN MUL = WC: MU = CR
IF J3(WC) + 1 > 0 THEN IF J(J3(WC) + 1, J4(WC) + 1) > 0 THEN MUL = WC: MU = CR
IF J3(WC) + 1 < 1 THEN IF J1(ABS(J3(WC) + 1), J4(WC) + 1) > 0 THEN MUL = WC: MU = CR
HAB = WC: H = CR: B9 = CHY(WC, CR)
QS1: NEXT F1
G1: NEXT CR
G2: NEXT SA
RETURN
S91: H2 = 0: FOR SI = 1 TO 15: ERASE SM: CNN = 0
IF SI = F1(U) AND RT = 0 THEN 71
S90: SRE = 0: SR = 1: SWN = 0: SHX(SI, 1) = J3(SI)
SJ3(0, SI) = J3(SI): SJ4(0, SI) = J4(SI): SFX(SI, 0) = J3(SI)
IF CI = SI THEN FG = 1 ELSE FG = 0
291 IF SM(SRE) = 1 THEN GOTO SS4
CK = J3(SI) + 2: CJ = J4(SI)
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB S10: GOTO SS4
IF CK > 0 THEN GOTO SS4
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB S10: GOTO SS4
SS4: IF SM(SRE) = 2 THEN GOTO SS3
CK = J3(SI) - 2: CJ = J4(SI)
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB S20: GOTO SS3
IF CK > 0 THEN GOTO SS3
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB S20
SS3: IF SM(SRE) = 3 THEN GOTO SS2
CK = J3(SI) + 1: CJ = J4(SI) + 1
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB S30: GOTO SS2
IF CK > 0 THEN GOTO SS2
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB S30
SS2: IF SM(SRE) = 4 THEN GOTO SS1
CK = J3(SI) + 1: CJ = J4(SI) - 1: IF CJ <= 0 THEN GOTO SS1
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB S40: GOTO SS1
IF CK > 0 THEN GOTO SS1
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB S40
SS1: IF SM(SRE) = 5 THEN GOTO SS
CK = J3(SI) - 1: CJ = J4(SI) + 1
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB S50: GOTO SS
IF CK > 0 THEN GOTO SS
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB S50
SS: IF SM(SRE) = 6 THEN GOTO S70
CK = J3(SI) - 1: CJ = J4(SI) - 1: IF CJ <= 0 THEN GOTO S70
IF CK > 0 THEN IF I(CK, CJ) > 0 OR J(CK, CJ) > 0 THEN GOSUB S60: GOTO S70
IF CK > 0 THEN GOTO S70
IF I1(ABS(CK), CJ) > 0 OR J1(ABS(CK), CJ) > 0 THEN GOSUB S60
S70: IF SRE > 0 THEN  ELSE GOTO S78
IF J3(SI) > 0 THEN J(J3(SI), J4(SI)) = 0 ELSE J1(ABS(J3(SI)), J4(SI)) = 0
IF FG = 0 AND RT <> 1 THEN GOTO DF
SY = SHY(SI, SR): SX = ABS(SHX(SI, SR))
IF SY > 0 THEN SY = SY + J4(SI) / 5
IF RT = 1 OR RT = 2 THEN IF B - 1 < -SY + (16 - SJ4(0, SI)) / 4 THEN  ELSE 15 ELSE 15
B8 = -SY + 8
IF J3(SI) > 0 THEN J(J3(SI), J4(SI)) = 0 ELSE J1(ABS(J3(SI)), J4(SI)) = 0
J3(SI) = SJ3(0, SI): J4(SI) = SJ4(0, SI)
IF JIN = 2 THEN CHY(F1(U), F2(U)) = -10: JK = 1
IF SJ3(0, SI) > 0 THEN J(SJ3(0, SI), SJ4(0, SI)) = SI: Z1 = Z1 - 1: RETURN FG
J1(ABS(SJ3(0, SI)), SJ4(0, SI)) = SI: Z1 = Z1 - 1: RETURN FG
15 IF -SY > B8 THEN B8 = -SY: EW3 = F1(U): EW4 = F2(U)
IF SY <= 0 THEN GOTO DF
IF SY >= b2 AND SX < 6 THEN b2 = SY: D2 = SX: H2 = SI: H4 = SR: EW1 = F1(U) ELSE 22
EW2 = F2(U): GOTO DF
22 IF SY = b2 AND SX <= D2 AND SX < 6 THEN b2 = SY: D2 = SX: H2 = SI: H4 = SR ELSE GOTO DF
EW1 = F1(U): EW2 = F2(U)
DF: SRE = SRE - 1: IF FG <> 0 OR RT = 1 THEN SR = SR + 1
IF SRE = CNN - 1 THEN FG = 0
IF JIN = 0 AND SI = CI THEN FG = 1
IF SRE = 0 AND CI <> SI THEN FG = 0
IF CI = SI THEN FG = 1
CX = CX + 1: DJ3(CX) = J3(SI): DJ4(CX) = J4(SI):
IF SWN = 1 THEN SWN = 0: SHY(SI, SR) = 0: Z1 = Z1 - 1: RETURN
SHY(SI, SR) = SFY(SI, SRE): SHX(SI, SR) = SFX(SI, SRE)
Z1 = Z1 - 1: RETURN
S78: SHY(SI, SR + 1) = -100
IF J3(SI) > 0 THEN J(J3(SI), J4(SI)) = 0 ELSE J1(ABS(J3(SI)), J4(SI)) = 0
J3(SI) = SJ3(SRE, SI): J4(SI) = SJ4(SRE, SI)
IF J3(SI) > 0 THEN J(J3(SI), J4(SI)) = SI ELSE J1(ABS(J3(SI)), J4(SI)) = SI
71 CX = 0: ERASE DJ4, DJ3:
IF JIN = 2 AND JK = 1 THEN RETURN
NEXT SI
IF b2 > 1 AND RT = 0 THEN CHY(CI, R) = CHY(CI, R) + SHY(H2, H4) - 2
IF b2 > 1 AND wh > 160 THEN CHY(CI, R) = CHY(CI, R) + 1
IF ZE <> 1 THEN b2 = 0
ERASE SHY, SHX, SJ3, SJ4, SM, SFX, SFY
82 FG = 0: CU = CU + 1: RETURN
S10: Z1 = Z1 + 1: CK1 = CK + 2: CJ1 = CJ: GOSUB 21
IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 811
IF CK1 > 0 THEN Z1 = Z1 - 1: RETURN SS4
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 811
IF CK1 < 1 THEN Z1 = Z1 - 1: RETURN SS4
811 GOSUB SGG
IF CK - 2 > 0 THEN J(CK - 2, CJ) = 0 ELSE J1(ABS(CK - 2), CJ) = 0
SHY(SI, SR) = SHY(SI, SR): SHX(SI, SR) = SHX(SI, SR) + 4
GOSUB SG2: SM(SRE) = 2: Z1 = Z1 + 1: GOSUB 291: GOSUB SE
Z1 = Z1 - 1: RETURN SS4
S20: Z1 = Z1 + 1: CK1 = CK - 2: CJ1 = CJ: GOSUB 21
IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 821
IF CK1 > 0 THEN Z1 = Z1 - 1: RETURN SS3
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 821
IF CK1 < 1 THEN Z1 = Z1 - 1: RETURN SS3
821 GOSUB SGG
IF CK + 2 > 0 THEN J(CK + 2, CJ) = 0 ELSE J1(ABS(CK + 2), CJ) = 0
SHY(SI, SR) = SHY(SI, SR): SHX(SI, SR) = SHX(SI, SR) - 4
GOSUB SG2: SM(SRE) = 1: Z1 = Z1 + 1: GOSUB 291: GOSUB SE
Z1 = Z1 - 1: RETURN SS3
S30: Z1 = Z1 + 1: CK1 = CK + 1: CJ1 = CJ + 1: GOSUB 21
IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 831
IF CK1 > 0 THEN Z1 = Z1 - 1: RETURN SS2
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 831
IF CK1 < 1 THEN Z1 = Z1 - 1: RETURN SS2
831 GOSUB SGG
IF CK - 1 > 0 THEN J(CK - 1, CJ - 1) = 0 ELSE J1(ABS(CK - 1), CJ - 1) = 0
SHY(SI, SR) = SHY(SI, SR) - 2: SHX(SI, SR) = SHX(SI, SR) + 2
GOSUB SG2: SM(SRE) = 6: Z1 = Z1 + 1: GOSUB 291: GOSUB SE
Z1 = Z1 - 1: RETURN SS2
S40: Z1 = Z1 + 1: CK1 = CK + 1: CJ1 = CJ - 1: GOSUB 21
IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 841
IF CK1 > 0 THEN Z1 = Z1 - 1: RETURN SS1
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 841
IF CK1 < 1 THEN Z1 = Z1 - 1: RETURN SS1
841 GOSUB SGG
IF CK - 1 > 0 THEN J(CK - 1, CJ + 1) = 0 ELSE J1(ABS(CK - 1), CJ + 1) = 0
SHY(SI, SR) = SHY(SI, SR) + 2: SHX(SI, SR) = SHX(SI, SR) + 2
GOSUB SG2: SM(SRE) = 5:  Z1 = Z1 + 1: GOSUB 291: GOSUB SE: Z1 = Z1 - 1
RETURN SS1
S50: Z1 = Z1 + 1: CK1 = CK - 1: CJ1 = CJ + 1: GOSUB 21
IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 851
IF CK1 > 0 THEN Z1 = Z1 - 1: RETURN SS
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 851
IF CK1 < 1 THEN Z1 = Z1 - 1: RETURN SS
851 GOSUB SGG
IF CK + 1 > 0 THEN J(CK + 1, CJ - 1) = 0 ELSE J1(ABS(CK + 1), CJ - 1) = 0
SHY(SI, SR) = SHY(SI, SR) - 2: SHX(SI, SR) = SHX(SI, SR) - 2
GOSUB SG2: SM(SRE) = 4: Z1 = Z1 + 1: GOSUB 291: GOSUB SE
Z1 = Z1 - 1: RETURN SS
S60: Z1 = Z1 + 1: CK1 = CK - 1: CJ1 = CJ - 1: GOSUB 21
IF CK1 > 0 THEN IF I(CK1, CJ1) = 0 AND J(CK1, CJ1) = 0 THEN 861
IF CK1 > 0 THEN Z1 = Z1 - 1:  RETURN S70
IF CK1 < 1 THEN IF I1(ABS(CK1), CJ1) = 0 AND J1(ABS(CK1), CJ1) = 0 THEN 861
IF CK1 < 1 THEN Z1 = Z1 - 1: RETURN S70
861 GOSUB SGG
IF CK + 1 > 0 THEN J(CK + 1, CJ + 1) = 0 ELSE J1(ABS(CK + 1), CJ + 1) = 0
SHY(SI, SR) = SHY(SI, SR) + 2: SHX(SI, SR) = SHX(SI, SR) - 2
GOSUB SG2: SM(SRE) = 3: Z1 = Z1 + 1: GOSUB 291: GOSUB SE
Z1 = Z1 - 1: RETURN S70

CHO: FOR J = 1 TO 15: HY2 = HY2 + I4(J): HY1 = HY1 + 16 - J4(J): NEXT J
IF HY2 > HY1 THEN LOCATE 14, 69: PRINT ">" ELSE
IF HY2 < HY1 THEN LOCATE 14, 69: PRINT "<" ELSE
IF HY2 = HY1 THEN LOCATE 14, 69: PRINT "=" ELSE
HY2 = 0
I(3, 4) = -1: I1(3, 4) = -1: I(1, 4) = -1: I1(1, 4) = -1: I(2, 3) = -1
I1(2, 3) = -1: I1(0, 3) = -1: I(1, 2) = -1: I1(1, 2) = -1: I1(0, 1) = -1
J(3, 12) = -1: J1(3, 12) = -1: J(1, 12) = -1: J1(1, 12) = -1: J(2, 13) = -1
J1(2, 13) = -1: J1(0, 13) = -1: J(1, 14) = -1: J1(1, 14) = -1: J1(0, 15) = -1
wh = HY1: HY1 = 0: IF wh > 60 THEN CHECK = 1: GOSUB CK
IF ZS = 0 AND CS <> 0 THEN LO = LO + 1: LOCATE 16, 72: PRINT LO ELSE 578
PUT (x, Y), Q1, PSET
XX1 = XX5: YY1 = YY5: x = X5: Y = Y5
GET (x, Y)-STEP(20, 20), Q1: v = x: P = Y: GOSUB 67
RETURN 1

578 IF ZS <> 0 AND CS = 0 THEN wi = wi + 1: LOCATE 16, 64: PRINT wi: RETURN 90
IF wi > -1 THEN wi = wi + 1: LOCATE 16, 64: PRINT wi
IF LOSE = 1 THEN LOCATE 16, 72: PRINT LO + 1
IF ZS = 0 AND CS = 0 THEN GOTO ED
RETURN
GG: FOR C = 0 TO RE
IF CK1 = CJ3(C, CI) AND CJ1 = CJ4(C, CI) THEN DE = RE: RETURN GG1
NEXT C
FOR J = 1 TO DX
IF CK1 = DJ1(J) AND CJ1 = DJ2(J) AND STE(J) > CN + 1 THEN  ELSE 28
FOR HJ = 1 TO 13: WAY1(CI, NUM(J), HJ) = 0: WAY2(CI, NUM(J), HJ) = 0
NEXT HJ
FOR HJ = 1 TO CN: WAY1(CI, NUM(J), HJ) = WAY1(CI, R, HJ)
WAY2(CI, NUM(J), HJ) = WAY2(CI, R, HJ)
NEXT HJ: WAY1(CI, NUM(J), CN + 1) = CK1: WAY2(CI, NUM(J), CN + 1) = CJ1
WAY2(CI, NUM(J), CN + 2) = -1: STE(J) = CN + 1
28 IF CK1 = DJ1(J) AND CJ1 = DJ2(J) THEN DE = RE: RETURN GG1
27 NEXT J
GG1: RETURN
GG2: IF CK1 > 0 THEN J(CK1, CJ1) = CI ELSE J1(ABS(CK1), CJ1) = CI
J3(CI) = CK1: J4(CI) = CJ1: RE = RE + 1: CJ3(RE, CI) = CK1: CJ4(RE, CI) = CJ1
FHY(CI, RE) = CHY(CI, R): FHX(CI, RE) = CHX(CI, R): DE = 100
WAY1(CI, R, CN) = CK1: WAY2(CI, R, CN) = CJ1: WWN = WWN + 1: RETURN
E: J3(CI) = CJ3(RE, CI): J4(CI) = CJ4(RE, CI)
IF J3(CI) > 0 THEN J(J3(CI), J4(CI)) = CI ELSE J1(ABS(J3(CI)), J4(CI)) = CI
RETURN
OK: IF CK > 0 THEN J(CK, CJ) = CI ELSE J1(ABS(CK), CJ) = CI
BK1 = J3(CI): BJ1 = J4(CI)
J3(CI) = CK: J4(CI) = CJ: RE = RE + 1: CJ3(RE, CI) = CK: CJ4(RE, CI) = CJ
WAY2(CI, R, 2) = -1: WAY1(CI, R, 1) = CK: WAY2(CI, R, 1) = CJ
CCK = CK: CCJ = CJ
IF OK = 1 THEN OK = 0: GOTO 89
88 IF FS = CI THEN 89
ERASE SHY, SHX: GOSUB OO
IF L = 1 THEN ERASE DJ3, DJ4, SHY, SHX, SJ3, SJ4, SM, SFX, SFY: b2 = 0
IF L = 1 THEN D2 = -10: CX = 0: FG = 0: BK = CCK: BJ = CCJ: Z1 = 0: CX = 0
IF L = 1 AND wh > 70 THEN L1 = 1: GOSUB S91
89 IF CCK > 0 THEN J(CCK, CCJ) = 0 ELSE J1(ABS(CCK), CCJ) = 0
RE = RE - 1
J3(CI) = CJ3(RE, CI): J4(CI) = CJ4(RE, CI)
IF J3(CI) > 0 THEN J(J3(CI), J4(CI)) = CI ELSE J1(ABS(J3(CI)), J4(CI)) = CI
RETURN
OK1: FOR I = 0 TO WRE
IF WK1 = WX(I) AND WJ1 = WY(I) THEN QB = QB - 1: RETURN OK2
NEXT I
IF WK1 > 0 THEN IF I(WK1, WJ1) = 0 AND J(WK1, WJ1) = 0 THEN 281
IF WK1 > 1 THEN QB = QB - 1: RETURN OK2
IF I1(ABS(WK1), WJ1) = 0 AND J1(ABS(WK1), WJ1) = 0 THEN 281
QB = QB - 1: RETURN OK2
281 IF WK1 = I3(W) AND WJ1 = I4(W) THEN RETURN 24
WRE = WRE + 1: WX(WRE) = WK1: WY(WRE) = WJ1
OK2: RETURN
OO: FK = J3(CI) + 2: FJ = J4(CI)
IF FK > 0 THEN IF I(FK, FJ) > 0 OR J(FK, FJ) > 0 THEN GOSUB 61: GOTO 31
IF FK > 0 THEN 31
IF I1(ABS(FK), FJ) > 0 OR J1(ABS(FK), FJ) > 0 THEN GOSUB 61
31 FK = J3(CI) - 2: FJ = J4(CI)
IF FK > 0 THEN IF I(FK, FJ) > 0 OR J(FK, FJ) > 0 THEN GOSUB 62: GOTO 35
IF FK > 0 THEN 35
IF I1(ABS(FK), FJ) > 0 OR J1(ABS(FK), FJ) > 0 THEN GOSUB 62
35 FK = J3(CI) + 1: FJ = J4(CI) - 1: IF FJ < 1 THEN 37
IF FK > 0 THEN IF I(FK, FJ) > 0 OR J(FK, FJ) > 0 THEN GOSUB 64: GOTO 37
IF FK > 0 THEN 37
IF I1(ABS(FK), FJ) > 0 OR J1(ABS(FK), FJ) > 0 THEN GOSUB 64
37 FK = J3(CI) - 1: FJ = J4(CI) - 1: IF FJ < 1 THEN 38
IF FK > 0 THEN IF I(FK, FJ) > 0 OR J(FK, FJ) > 0 THEN GOSUB 66: GOTO 38
IF FK > 0 THEN 38
IF I1(ABS(FK), FJ) > 0 OR J1(ABS(FK), FJ) > 0 THEN GOSUB 66
38 L = 1: RETURN
61 FK1 = FK + 2: FJ1 = FJ:
IF FK1 > 0 THEN IF I(FK1, FJ1) > 0 THEN L = 0: RETURN 161
IF FK1 < 1 THEN IF I1(ABS(FK1), FJ1) > 0 THEN L = 0: RETURN 161
161 RETURN
62 FK1 = FK - 2: FJ1 = FJ
IF FK1 > 0 THEN IF I(FK1, FJ1) > 0 THEN L = 0: RETURN 162
IF FK1 < 1 THEN IF I1(ABS(FK1), FJ1) > 0 THEN L = 0: RETURN 162
162 RETURN
64  FK1 = FK + 1: FJ1 = FJ - 1
IF FK1 > 0 THEN IF I(FK1, FJ1) > 0 THEN L = 0: RETURN 164
IF FK1 < 1 THEN IF I1(ABS(FK1), FJ1) > 0 THEN L = 0: RETURN 164
164 RETURN
66 FK1 = FK - 1: FJ1 = FJ - 1
IF FK1 > 0 THEN IF I(FK1, FJ1) > 0 THEN L = 0: RETURN 166
IF FK1 < 1 THEN IF I1(ABS(FK1), FJ1) > 0 THEN L = 0: RETURN 166
166 RETURN
OO1: FK = J3(SI) + 2: FJ = J4(SI)
IF FK > 0 THEN IF I(FK, FJ) > 0 OR J(FK, FJ) > 0 THEN GOSUB 151: GOTO 131
IF FK > 0 THEN 131
IF I1(ABS(FK), FJ) > 0 OR J1(ABS(FK), FJ) > 0 THEN GOSUB 151
131 FK = J3(SI) - 2: FJ = J4(SI)
IF FK > 0 THEN IF I(FK, FJ) > 0 OR J(FK, FJ) > 0 THEN GOSUB 152: GOTO 135
IF FK > 0 THEN 135
IF I1(ABS(FK), FJ) > 0 OR J1(ABS(FK), FJ) > 0 THEN GOSUB 152
135 FK = J3(SI) + 1: FJ = J4(SI) - 1: IF FJ < 1 THEN 137
IF FK > 0 THEN IF I(FK, FJ) > 0 OR J(FK, FJ) > 0 THEN GOSUB 154
IF FK < 1 THEN IF I1(ABS(FK), FJ) > 0 OR J1(ABS(FK), FJ) > 0 THEN GOSUB 154
IF FK > 0 THEN IF I(FK, FJ) > 0 THEN GOTO 137
IF FK < 1 THEN IF I1(ABS(FK), FJ) > 0 THEN  ELSE
137 FK = J3(SI) - 1: FJ = J4(SI) - 1: IF FJ < 1 THEN 139
IF FK > 0 THEN IF I(FK, FJ) > 0 OR J(FK, FJ) > 0 THEN GOSUB 256 ELSE
IF FK < 1 THEN IF I1(ABS(FK), FJ) > 0 OR J1(ABS(FK), FJ) > 0 THEN GOSUB 256
IF FK > 0 THEN IF I(FK, FJ) > 0 THEN 139
IF FK < 1 THEN IF I1(ABS(FK), FJ) > 0 THEN  ELSE
139 FK = J3(SI) + 1: FJ = J4(SI) + 1
IF FK > 0 THEN IF I(FK, FJ) > 0 OR J(FK, FJ) > 0 THEN GOSUB 155: GOTO 140
IF FK > 0 THEN 140
IF I1(ABS(FK), FJ) > 0 OR J1(ABS(FK), FJ) > 0 THEN GOSUB 155
140 FK = J3(SI) - 1: FJ = J4(SI) + 1
IF FK > 0 THEN IF I(FK, FJ) > 0 OR J(FK, FJ) > 0 THEN GOSUB 157: GOTO 138
IF FK > 0 THEN 138
IF I1(ABS(FK), FJ) > 0 OR J1(ABS(FK), FJ) > 0 THEN GOSUB 157
138 L1 = 1: RETURN
151 FK1 = FK + 2: FJ1 = FJ
IF FK1 > 0 THEN IF I(FK1, FJ1) > 0 THEN L1 = 0: RETURN 251
IF FK1 < 1 THEN IF I1(ABS(FK1), FJ1) > 0 THEN L1 = 0: RETURN 251
251 RETURN
152 FK1 = FK - 2: FJ1 = FJ
IF FK1 > 0 THEN IF I(FK1, FJ1) > 0 THEN L1 = 0: RETURN 252
IF FK1 < 1 THEN IF I1(ABS(FK1), FJ1) > 0 THEN L1 = 0: RETURN 252
252 RETURN
154  FK1 = FK + 1: FJ1 = FJ - 1
IF FK1 > 0 THEN IF I(FK1, FJ1) > 0 THEN L1 = 0: RETURN 254
IF FK1 < 1 THEN IF I1(ABS(FK1), FJ1) > 0 THEN L1 = 0: RETURN 254
254 RETURN
256 FK1 = FK - 1: FJ1 = FJ - 1
IF FK1 > 0 THEN IF I(FK1, FJ1) > 0 THEN L1 = 0: RETURN 266
IF FK1 < 1 THEN IF I1(ABS(FK1), FJ1) > 0 THEN L1 = 0: RETURN 266
266 RETURN
155 FK1 = FK + 1: FJ1 = FJ + 1
IF FK1 > 0 THEN IF I(FK1, FJ1) > 0 THEN L1 = 0: RETURN 255
IF FK1 < 1 THEN IF I1(ABS(FK1), FJ1) > 0 THEN L1 = 0: RETURN 255
255 RETURN
157 FK1 = FK - 1: FJ1 = FJ + 1
IF FK1 > 0 THEN IF I(FK1, FJ1) > 0 THEN L1 = 0: RETURN 257
IF FK1 < 1 THEN IF I1(ABS(FK1), FJ1) > 0 THEN L1 = 0: RETURN 257
257 RETURN
SGG: FOR CH = 0 TO SRE
IF CK1 = SJ3(CH, SI) AND CJ1 = SJ4(CH, SI) THEN Z1 = Z1 - 1: RETURN SG1
NEXT
FOR J1 = 1 TO CX
IF CK1 = DJ3(J1) AND CJ1 = DJ4(J1) THEN Z1 = Z1 - 1: RETURN SG1
NEXT J1
IF CK1 = BK1 AND CJ1 = BJ1 THEN FG = 1
IF CK = BK AND CJ = BJ THEN FG = 2
IF FG <> 0 AND CNN = 0 THEN CNN = SRE + 1
SG1: RETURN
SG2: IF CK1 > 0 THEN J(CK1, CJ1) = SI ELSE J1(ABS(CK1), CJ1) = SI
J3(SI) = CK1: J4(SI) = CJ1: SRE = SRE + 1: SJ3(SRE, SI) = CK1
SJ4(SRE, SI) = CJ1
SFY(SI, SRE) = SHY(SI, SR): SFX(SI, SRE) = SHX(SI, SR): SWN = SWN + 1: RETURN
SE: J3(SI) = SJ3(SRE, SI): J4(SI) = SJ4(SRE, SI)
IF J3(SI) > 0 THEN J(J3(SI), J4(SI)) = SI ELSE J1(ABS(J3(SI)), J4(SI)) = SI
RETURN
FG: DO
Z1 = Z1 - 1
RETURN 13
13 LOOP UNTIL Z1 = 0
IF J3(SI) > 0 THEN J(J3(SI), J4(SI)) = 0 ELSE J1(ABS(J3(SI)), J4(SI)) = 0
J3(SI) = SJ3(0, SI): J4(SI) = SJ4(0, SI)
IF J3(SI) > 0 THEN J(J3(SI), J4(SI)) = SI ELSE J1(ABS(J3(SI)), J4(SI)) = SI
L1 = 0
RETURN
21 IF FG <> 0 AND SHY(SI, SR) > 2 AND RT = 0 AND wh < 150 THEN GOSUB OO1
IF L1 <> 1 AND RT = 0 THEN RETURN FG
RETURN
RETURN
SP: JIN = 0: FOR F = 1 TO 15
IF I3(F) > 0 THEN I(I3(F), I4(F)) = 0 ELSE I1(ABS(I3(F)), I4(F)) = 0
IF J3(F) > 0 THEN J(J3(F), J4(F)) = 0 ELSE J1(ABS(J3(F)), J4(F)) = 0
SWAP J3(F), I3(F): SWAP J4(F), I4(F):
IF I3(F) > 0 THEN I(I3(F), I4(F)) = F ELSE I1(ABS(I3(F)), I4(F)) = F
IF J3(F) > 0 THEN J(J3(F), J4(F)) = F ELSE J1(ABS(J3(F)), J4(F)) = F
NEXT F: RETURN
232 INPUT F$
F$ = F$ + ".DIA"
CLOSE #1
OPEN F$ FOR OUTPUT AS #1
FOR H = 1 TO 15: PRINT #1, I3(H); I4(H); J3(H); J4(H)
NEXT H: CLOSE #1:
OPEN "DIAMOND.TLT" FOR APPEND AS #1
PRINT #1, F$: CLOSE #1
LINE (0, 190)-STEP(110, 20), 0, BF
GOTO 1
912 IF CHY(CI, R) > 3 AND JIN = 0 THEN GOSUB OO
IF L = 0 AND JIN = 0 AND wh < 75 THEN CHY(CI, R) = 2 * CHY(CI, R) - 2: RETURN 913
RETURN
913 RETURN 87
67 LINE (v + 5, P + 1)-STEP(14, 7), 8
LINE (v + 19, P + 8)-STEP(-3, 3), 8: LINE (v + 16, P + 11)-STEP(4, 4), 8
LINE (v + 5, P + 2)-STEP(3, 14), 8: LINE (v + 8, P + 16)-STEP(4, -2), 8
LINE (v + 12, P + 14)-STEP(4, 4), 8: LINE (v + 16, P + 18)-STEP(4, -2), 8
PAINT (v + 8, P + 9), 8
LINE (v + 3, P + 1)-STEP(14, 7), 7
LINE (v + 17, P + 8)-STEP(-3, 3), 7: LINE (v + 14, P + 11)-STEP(4, 4), 7
LINE (v + 3, P + 2)-STEP(3, 14), 7: LINE (v + 6, P + 16)-STEP(4, -2), 7
LINE (v + 10, P + 14)-STEP(4, 4), 7: LINE (v + 14, P + 18)-STEP(4, -2), 7
PSET (v + 7, P + 15), 15: PAINT (v + 6, P + 9), 15, 7
RETURN
ED: LINE (1, 1)-(639, 349), 9, B
SLEEP (2)
BW = 1
CLOSE #1
OPEN "G1" FOR INPUT AS #1
FOR GJ = 0 TO 174 STEP .04
LINE (GJ + 1, GJ + 1)-(639 - GJ, 349 - GJ), 9, B
LINE (GJ, GJ)-(640 - GJ, 350 - GJ), 0, B
INPUT #1, b2(f5): f5 = f5 + 1
INPUT #1, b2(f5): f5 = f5 + 1
IF GJ MOD 20 = 0 THEN GOSUB 121
NEXT GJ: BW = 0
LINE (0, 175)-(640, 175), 0
555 FOR F = f5 TO 9180
IF F MOD 100 = 0 THEN GOSUB 121: GOSUB 121: GOSUB 121: GOSUB 121
INPUT #1, b2(F)
NEXT F
PUT (167, 62), b2
FOR YU = 1 TO 400
GOSUB 121: NEXT
CLOSE #1
CLOSE #2
OPEN "DIA.GRA" FOR INPUT AS #2
FOR SO = 1 TO 685
INPUT #2, D, A: GOSUB 121
PSET (262 + D, 196 + A), 8: PSET (263 + D, 197 + A), 7
PSET (261 + D, 195 + A), 15
NEXT SO
CLOSE #2
123 GOSUB 121
GOTO 123
121
FOR I = 1 TO 1
J = INT(RND * 70)
PC = INT(J MOD 9) + 8
IF PC = 8 OR PC = 7 THEN PC = 15
IF PN(J) = 0 THEN  ELSE 124
IF BW <> 1 THEN LINE (PX(J) - 5, PY(J) - 5)-STEP(10, 10), 0, BF
PN(J) = 1
IF PY(J) < 110 OR PY(J) > 260 THEN PX(J) = INT(RND * 640): GOTO 18
241 IF PX(J) > 170 AND PX(J) < 470 THEN PX(J) = INT(RND * 640): GOTO 241
18 IF PX(J) < 170 OR PX(J) > 470 THEN PY(J) = INT(RND * 350): GOTO 17
242 IF PY(J) > 110 AND PY(J) < 260 THEN PY(J) = 10 + INT(RND * 350): GOTO 242
GOTO 17
124 IF PX(J) > 260 AND PX(J) < 360 THEN IF PY(J) > 170 THEN PY(J) = RND * 54 ELSE PY(J) = 350 - RND * 54
IF PN(J) = 1 THEN CIRCLE (PX(J), PY(J)), 1, PC: PN(J) = INT(RND * 3)
IF PN = 1 THEN 17
IF PN(J) = 2 THEN CIRCLE (PX(J), PY(J)), 1.5, PC ELSE 17
LINE (PX(J) - 5, PY(J))-STEP(10, 0), PC
LINE (PX(J), PY(J) - 5)-STEP(0, 10), PC
LINE (PX(J) - 2, PY(J) - 2)-STEP(4, 4), PC
LINE (PX(J) - 2, PY(J) + 2)-STEP(4, -4), PC
CIRCLE (PX(J), PY(J)), RND + 2.5, 0:
PN(J) = 0
A4$ = INKEY$: IF A4$ = " " THEN CLEAR : STT = 3: GOTO START
IF A4$ = CHR$(27) THEN END
17 NEXT I
211 RETURN
DATA 852043,0,0,0,0,0,0,0,0,0,0,536879104,57359,536870912,-535879680,0
DATA 536879104,57359,536870912,-535879680,0,276713480,32769,1342701568
DATA -2147413890,0,276713480,32769,1476919296,-134014850,0,268587016,24582
DATA 1342701568,1611010050,0,268587016,24582,1409941504,1611043871,0
DATA 503607312,12312,1880096768,806886916,0,503607312,12312,1947336704
DATA -1206280700,0,269242422,65151,1345716224,-25227252,0,269242422,65151
DATA 1547108352,-16836851,0,269488194,1,272760832,69648,0,269488194,1
DATA -1807089664,-14740462,128,-265822208,404275207,-536870888,-1073221593
DATA 1579032,-265822208,404275207,-468713448,-1073220569,1579032,268439553
DATA 404234248,268501016,537399296,1579032,268439553,404234248,939589656
DATA -267781111,1973790,268439553,8200,268500992,537399296,0,268439553,8200
DATA 1409351680,671749120,394758,268492800,49159,-536870912,-1073278976,0
DATA 268492800,49159,-469762048,-939060224,0,0,0,0,0,0,0,0,939524096
DATA -268368896,0,0,0,0,0,0,0,0,0,0,0

SUB s
SOUND 6000, 2: SOUND 5300, 2: SOUND 4000, 3
SOUND 5000, 2: SOUND 4300, 2: SOUND 3000, 3
END SUB

